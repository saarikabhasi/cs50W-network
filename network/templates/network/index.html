{% extends "network/layout.html" %}

{% block title %}
    Posts
{% endblock %}
{% load static %}
{% block body %}

<script type ="text/javascript" src="{% static 'util.js' %}"></script>

    <!-- <h1 id="page-heading"> All posts</h1> -->
    
    <form action="{% url 'network:newpost' %}" method ="POST">
        {% csrf_token %}    
       <div id ="newpost-button"><button type = "submit" name ="newpost" id ="newpost">New post</button></div> 
    </form> 


    <div id ="showposts"> 
        {% for post in allposts %}
            

            <div id = eachpost_{{post.id}} class="posts">

                <h5 id ="post_userid">{{post.user_id}}</h5>
                <p id ="post_content">{{post.contents}}</p>
                <p d ="post_dateandtime">{{post.date_and_time}}</p>
                <p id ='num_likes_{{post.id}}'>{{post.num_of_likes}}</p>


                {% if post.num_of_likes > 0 and post_liked_ids|length  and post.id in post_liked_ids %}
                
                    <button id ="like" style = "width: 80px;" value ="{{post.id}}" ><i class="fa fa-heart" style = "color:red"></i></button>

                {% else %}
                    <button id ="like" style = "width: 80px;" value ="{{post.id}}" ><i class="fa fa-heart" style = "color:white"></i></button>

                {% endif %}
                {% with post_username=post.user_id %}
                
                
                {% ifequal post_username|lower user.username|lower %}
                    
                <!-- <div id ="editpost_{{post.id}}"> -->
                  
                <button id = "edit" name ="edit"type="submit" value= {{post.id}} onclick = "edit_post('{{ post.id }}','{{ post_username }}')">edit</button>
                    
                <!-- </div> -->
                <div id = "editpost">

                </div>
                <hr class="hr_divide_heading">  
                {%endifequal%}
                {%endwith%}
                
            </div>
            {% empty %}

            <h5>No posts</h5>
            
        {% endfor %}
    </div>
        

    
    {% if allposts.has_other_pages %}
        <ul class="pagination">
            {% if allposts.has_previous %}
            <li class="page-item"><a class="page-link" href="?page={{ allposts.previous_page_number }}">&laquo;</a></li>
            {% else %}
            <li class="disabled"><span class="page-link">&laquo;</span></li>
            {% endif %}
            {% for i in allposts.paginator.page_range %}
                {% if allposts.number == i %}
                    <li class="active page-item"><span class="page-link">{{ i }} <span class="sr-only">(current)</span></span></li>
                {% else %}
                    <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                {% endif %}
            {% endfor %}
            {% if allposts.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ allposts.next_page_number }}">&raquo;</a></li>
            {% else %}
            <li class="disabled page-item"><span class="page-link">&raquo;</span></li>
            {% endif %}
        </ul>
    {% endif %}

    <script type ="text/javascript" src="{% static 'index.js' %}"></script>

    
        

  
{% endblock %}