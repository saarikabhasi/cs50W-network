{% extends "network/layout.html" %}

{% block title %}
    Profile
{% endblock %}
{%load static %}

{% block body %}


    <!-- This html page shows current and other user profile     
    1. display all the posts with pagination
    2. user can like any post 
    3. user can edit their own post -->

<script>
    const username ="{{username}}"
</script>

<script type ="text/javascript" src="{% static 'util.js' %}"></script>
<div id = "profile">
    <div id ="profile-nav">
        <h1>{{username}}</h1>
        <div><span id ="connect"></span></div>
        <div class ="follow">
           
                <span id = "following_count">{{following_count}}  Following  </span> 
                <span id = "follower_count">{{follower_count}} Followers</span>
              
        </div>
        <hr>

{% if page_info == "current user" %}
        <!-- profile page of logged in user -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <ul class="navbar-nav">
                <li class="nav-item ">
 
                    <button  class ="active" data-section="myposts">my Posts </button>
                </li>
                <li class="nav-item">

                    <button data-section="networks">networks</button>
                </li>
                <li class="nav-item">
                    
                    <button data-section="likes">Likes</button>
                </li>
            </ul>
        </nav>
    
    </div>
    <div id ="result">
  
    </div>




</div>

<script type ="text/javascript" src="{% static 'profile.js' %}"></script>

{% else %}
<!-- profile page of other user -->
<section >
    <article class = "other_profile">
        <div class ="message">

        </div>

        
        <div id ="showposts"> 
            {% for post in posts %}
                <hr class="hr_divide_heading">  
                <div id= "post">
                    <h5>{{post.user_id}}</h5>
                    <p>{{post.contents}}</p>
                    <p>{{post.date_and_time}}</p>
                    <p>{{post.num_of_likes}}</p>
                    {% if post.num_of_likes > 0 and post_liked_ids|length  and post.id in post_liked_ids %}
                

                        <a id ="like" href = "" data-section = "{{post.id}}"><i class="fa fa-heart" style = "color:red"></i></a>

                {% else %}
                        <a id ="like" href = "" data-section = "{{post.id}}"><i class="fa fa-heart" style = "color:white"></i></a>
                    
                {% endif %}
                </div>
                {% empty %}
    
                <h5>No posts</h5>
            {% endfor %}
        </div>
    </article>

</section>
<script>
    // follow/unfollow option while displaying other user profile

    connect =  "{{connect}}"
    user_id = "{{other_user_id}}"
    
    loc ="{% url 'network:connect' user=username  %}"
    var form = createForm("post",loc)
    var crsf = formCrsf();
 
    if (connect == "following"){
        var togglebutton = createElement('span',null,null,'<input type= "hidden"  name = "change"  value ='+user_id+' /> <input type= "submit"  name = "btn"  value =  unfollow />')
        }
        else{
        var togglebutton = createElement('span',null,null,'<input type= "hidden"  name = "change"  value ='+user_id+' /> <input type= "submit"  name = "btn"  value =  follow />')
        }
        
    appendChild(parent =form,crsf,togglebutton);
    document.querySelector("#connect").appendChild(form)
    
  
</script>
{% endif %}


{% endblock %}